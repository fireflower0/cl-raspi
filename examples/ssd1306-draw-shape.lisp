(defpackage :cl-raspi/examples/ssd1306-draw-shape
  (:use :cl
        :cl-raspi/lib-wiring-pi
        :cl-raspi/ssd1306)
  (:export :main))
(in-package :cl-raspi/examples/ssd1306-draw-shape)

(defun example-draw-pixel ()
  (ssd1306-draw-pixel  10 10 :color +white+)
  (ssd1306-draw-pixel 117 10 :color +white+)
  (ssd1306-draw-pixel 117 53 :color +white+)
  (ssd1306-draw-pixel  10 53 :color +white+)
  (ssd1306-display)
  (delay 1000)
  (ssd1306-clear-display))

(defun example-draw-line ()
  (ssd1306-draw-line 0 0 127 63)
  (ssd1306-draw-line 127 0 0 63)
  (ssd1306-display)
  (delay 1000)
  (ssd1306-clear-display))

(defun example-draw-rect ()
  (ssd1306-draw-rect 10 10 44 44 :color +white+)
  (ssd1306-draw-fill-rect 74 10 44 44 :color +white+)
  (ssd1306-display)
  (delay 1000)
  (ssd1306-clear-display))

(defun example-draw-triangle ()
  (ssd1306-draw-triangle 32 25 57 50 7 50 :color +white+)
  (ssd1306-draw-fill-triangle 96 25 121 50 71 50 :color +white+)
  (ssd1306-display)
  (delay 1000)
  (ssd1306-clear-display))

(defun example-draw-circle ()
  (ssd1306-draw-circle 32 32 30 :color +white+)
  (ssd1306-draw-fill-circle 96 32 30 :color +white+)
  (ssd1306-display)
  (delay 1000)
  (ssd1306-clear-display))

(defun example-invert-display ()
  (ssd1306-draw-fill-rect 10 10 108 44 :color +white+)
  (dotimes (n 10)
    (if (zerop (rem n 2))
        (ssd1306-invert-display t)
        (ssd1306-invert-display nil))
    (ssd1306-display)
    (delay 1000))
  (delay 1000)
  (ssd1306-clear-display))

(defun example-draw-string ()
  (ssd1306-draw-string 10 16 "Hello, world!" :fill t)
  (ssd1306-draw-string 10 32 "Hello, world!")
  (ssd1306-display)
  (delay 1000)
  (ssd1306-clear-display))

(defun main ()
  (ssd1306-init)
  (example-draw-pixel)
  (example-draw-line)
  (example-draw-rect)
  (example-draw-triangle)
  (example-draw-circle)
  (example-invert-display)
  (example-draw-string))
